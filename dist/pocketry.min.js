!function(t){function e(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}function i(t,e){var i=n(t,e)?r:o;i(t,e)}var n,o,r;"classList"in document.documentElement?(n=function(t,e){return t.classList.contains(e)},o=function(t,e){t.classList.add(e)},r=function(t,e){t.classList.remove(e)}):(n=function(t,i){return e(i).test(t.className)},o=function(t,e){n(t,e)||(t.className=t.className+" "+e)},r=function(t,i){t.className=t.className.replace(e(i)," ")});var s={hasClass:n,addClass:o,removeClass:r,toggleClass:i,has:n,add:o,remove:r,toggle:i};"function"==typeof define&&define.amd?define("classie/classie",s):"object"==typeof exports?module.exports=s:t.classie=s}(window),function(){function t(){}function e(t,e){for(var i=t.length;i--;)if(t[i].listener===e)return i;return-1}function i(t){return function(){return this[t].apply(this,arguments)}}var n=t.prototype,o=this,r=o.EventEmitter;n.getListeners=function(t){var e,i,n=this._getEvents();if(t instanceof RegExp){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},n.flattenListeners=function(t){var e,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].listener);return i},n.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},n.addListener=function(t,i){var n,o=this.getListenersAsObject(t),r="object"==typeof i;for(n in o)o.hasOwnProperty(n)&&-1===e(o[n],i)&&o[n].push(r?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(t){return this.getListeners(t),this},n.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},n.removeListener=function(t,i){var n,o,r=this.getListenersAsObject(t);for(o in r)r.hasOwnProperty(o)&&(n=e(r[o],i),-1!==n&&r[o].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},n.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},n.manipulateListeners=function(t,e,i){var n,o,r=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)r.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(o=e[n])&&("function"==typeof o?r.call(this,n,o):s.call(this,n,o));return this},n.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if(t instanceof RegExp)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(t,e){var i,n,o,r,s=this.getListenersAsObject(t);for(o in s)if(s.hasOwnProperty(o))for(n=s[o].length;n--;)i=s[o][n],i.once===!0&&this.removeListener(t,i.listener),r=i.listener.apply(this,e||[]),r===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},n.trigger=i("emitEvent"),n.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},n.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return o.EventEmitter=r,t},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}.call(this),function(t){function e(e){var i=t.event;return i.target=i.target||i.srcElement||e,i}var i=document.documentElement,n=function(){};i.addEventListener?n=function(t,e,i){t.addEventListener(e,i,!1)}:i.attachEvent&&(n=function(t,i,n){t[i+n]=n.handleEvent?function(){var i=e(t);n.handleEvent.call(n,i)}:function(){var i=e(t);n.call(t,i)},t.attachEvent("on"+i,t[i+n])});var o=function(){};i.removeEventListener?o=function(t,e,i){t.removeEventListener(e,i,!1)}:i.detachEvent&&(o=function(t,e,i){t.detachEvent("on"+e,t[e+i]);try{delete t[e+i]}catch(n){t[e+i]=void 0}});var r={bind:n,unbind:o};"function"==typeof define&&define.amd?define("eventie/eventie",r):"object"==typeof exports?module.exports=r:t.eventie=r}(this),function(t){function e(t){if(t){if("string"==typeof n[t])return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e,o=0,r=i.length;r>o;o++)if(e=i[o]+t,"string"==typeof n[e])return e}}var i="Webkit Moz ms Ms O".split(" "),n=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return e}):"object"==typeof exports?module.exports=e:t.getStyleProperty=e}(window),function(t){function e(t){var e=parseFloat(t),i=-1===t.indexOf("%")&&!isNaN(e);return i&&e}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0,i=s.length;i>e;e++){var n=s[e];t[n]=0}return t}function n(t){function n(t){if("string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var n=r(t);if("none"===n.display)return i();var o={};o.width=t.offsetWidth,o.height=t.offsetHeight;for(var h=o.isBorderBox=!(!c||!n[c]||"border-box"!==n[c]),p=0,f=s.length;f>p;p++){var l=s[p],d=n[l];d=a(t,d);var g=parseFloat(d);o[l]=isNaN(g)?0:g}var y=o.paddingLeft+o.paddingRight,m=o.paddingTop+o.paddingBottom,v=o.marginLeft+o.marginRight,x=o.marginTop+o.marginBottom,b=o.borderLeftWidth+o.borderRightWidth,w=o.borderTopWidth+o.borderBottomWidth,S=h&&u,E=e(n.width);E!==!1&&(o.width=E+(S?0:y+b));var P=e(n.height);return P!==!1&&(o.height=P+(S?0:m+w)),o.innerWidth=o.width-(y+b),o.innerHeight=o.height-(m+w),o.outerWidth=o.width+v,o.outerHeight=o.height+x,o}}function a(t,e){if(o||-1===e.indexOf("%"))return e;var i=t.style,n=i.left,r=t.runtimeStyle,s=r&&r.left;return s&&(r.left=t.currentStyle.left),i.left=e,e=i.pixelLeft,i.left=n,s&&(r.left=s),e}var u,c=t("boxSizing");return function(){if(c){var t=document.createElement("div");t.style.width="200px",t.style.padding="1px 2px 3px 4px",t.style.borderStyle="solid",t.style.borderWidth="1px 2px 3px 4px",t.style[c]="border-box";var i=document.body||document.documentElement;i.appendChild(t);var n=r(t);u=200===e(n.width),i.removeChild(t)}}(),n}var o=t.getComputedStyle,r=o?function(t){return o(t,null)}:function(t){return t.currentStyle},s=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],n):"object"==typeof exports?module.exports=n(require("get-style-property")):t.getSize=n(t.getStyleProperty)}(window),function(t){function e(t,e){for(var i in e)t[i]=e[i];return t}function i(){}function n(n,o,s,c,h){function f(t,i){this.element="string"==typeof t?r.querySelector(t):t,this.options=e({distance:1,forceTranslatePositioning:!1},this.options),e(this.options,i),this._create()}function l(){return!1}function d(t,e){t.x=void 0!==e.pageX?e.pageX:e.clientX,t.y=void 0!==e.pageY?e.pageY:e.clientY}function g(t,e,i){return i=i||"round",e?Math[i](t/e)*e:t}var y=c("transform"),m=!!c("perspective");e(f.prototype,o.prototype),f.prototype.options={},f.prototype._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=e({},this.position);var t=a(this.element);"relative"!==t.position&&"absolute"!==t.position&&(this.element.style.position="relative"),this.enable(),this.setHandles()},f.prototype.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element];for(var e=0,i=this.handles.length;i>e;e++){var n=this.handles[e];t.navigator.pointerEnabled?(s.bind(n,"pointerdown",this),n.style.touchAction="none"):t.navigator.msPointerEnabled?(s.bind(n,"MSPointerDown",this),n.style.msTouchAction="none"):(s.bind(n,"mousedown",this),s.bind(n,"touchstart",this),x(n))}};var v="attachEvent"in r.documentElement,x=v?function(t){"IMG"===t.nodeName&&(t.ondragstart=l);for(var e=t.querySelectorAll("img"),i=0,n=e.length;n>i;i++){var o=e[i];o.ondragstart=l}}:i;f.prototype._getPosition=function(){var t=a(this.element),e=parseInt(t.left,10),i=parseInt(t.top,10);this.position.x=isNaN(e)?0:e,this.position.y=isNaN(i)?0:i,this._addTransformPosition(t)},f.prototype._addTransformPosition=function(t){if(y){var e=t[y];if(0===e.indexOf("matrix")){var i=e.split(","),n=0===e.indexOf("matrix3d")?12:4,o=parseInt(i[n],10),r=parseInt(i[n+1],10);this.position.x+=o,this.position.y+=r}}},f.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},f.prototype.getTouch=function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];if(n.identifier===this.pointerIdentifier)return n}},f.prototype.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this.beforeDragStart(t,t)},f.prototype.ontouchstart=function(t){this.isDragging||this.beforeDragStart(t,t.changedTouches[0])},f.prototype.onMSPointerDown=f.prototype.onpointerdown=function(t){this.isDragging||this.beforeDragStart(t,t)};var b={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"],MSPointerDown:["MSPointerMove","MSPointerUp","MSPointerCancel"]};f.prototype.beforeDragStart=function(e,i){this.isEnabled&&(0===this.options.distance&&(e.preventDefault?e.preventDefault():e.returnValue=!1),this.pointerIdentifier=void 0!==i.pointerId?i.pointerId:i.identifier,this._getPosition(),this.measureContainment(),d(this.startPoint,i),this._bindEvents({events:b[e.type],node:e.preventDefault?t:r}))},f.prototype.dragStart=function(t,e){this.isDragging||(this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,n.add(this.element,"is-dragging"),n.add(this.element,"dragged"),this.isDragging=!0,this.emitEvent("dragStart",[this,t,e]),this.animate())},f.prototype._bindEvents=function(t){for(var e=0,i=t.events.length;i>e;e++){var n=t.events[e];s.bind(t.node,n,this)}this._boundEvents=t},f.prototype._unbindEvents=function(){var t=this._boundEvents;if(t&&t.events){for(var e=0,i=t.events.length;i>e;e++){var n=t.events[e];s.unbind(t.node,n,this)}delete this._boundEvents}},f.prototype.measureContainment=function(){var t=this.options.containment;if(t){this.size=h(this.element);var e=this.element.getBoundingClientRect(),i=u(t)?t:"string"==typeof t?r.querySelector(t):this.element.parentNode;this.containerSize=h(i);var n=i.getBoundingClientRect();this.relativeStartPosition={x:e.left-n.left,y:e.top-n.top}}},f.prototype.elementHasMoved=function(){var t=this.startPoint,e=this.dragPoint,i=e.x-t.x,n=e.y-t.y;return i*i+n*n>this.options.distance*this.options.distance},f.prototype.onmousemove=function(t){this.dragMove(t,t)},f.prototype.onMSPointerMove=f.prototype.onpointermove=function(t){t.pointerId===this.pointerIdentifier&&this.dragMove(t,t)},f.prototype.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this.dragMove(t,e)},f.prototype.dragMove=function(t,e){if(d(this.dragPoint,e),this.isDragging){var i=this.dragPoint.x-this.startPoint.x,n=this.dragPoint.y-this.startPoint.y,o=this.options.grid,r=o&&o[0],s=o&&o[1];i=g(i,r),n=g(n,s),i=this.containDrag("x",i,r),n=this.containDrag("y",n,s),i="y"===this.options.axis?0:i,n="x"===this.options.axis?0:n,this.position.x=this.startPosition.x+i,this.position.y=this.startPosition.y+n,this.dragPoint.x=i,this.dragPoint.y=n,this.emitEvent("dragMove",[this,t,e])}else this.elementHasMoved()&&this.dragStart(t,e)},f.prototype.containDrag=function(t,e,i){if(!this.options.containment)return e;var n="x"===t?"width":"height",o=this.relativeStartPosition[t],r=g(-o,i,"ceil"),s=this.containerSize[n]-o-this.size[n];return s=g(s,i,"floor"),Math.min(s,Math.max(r,e))},f.prototype.onmouseup=function(t){this.dragEnd(t,t)},f.prototype.onMSPointerUp=f.prototype.onpointerup=function(t){t.pointerId===this.pointerIdentifier&&this.dragEnd(t,t)},f.prototype.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this.dragEnd(t,e)},f.prototype.dragEnd=function(t,e){if(this._unbindEvents(),!this.isDragging)return!1;this.isDragging=!1,delete this.pointerIdentifier,y&&(this.element.style[y]="",this.setLeftTop());var i=this;setTimeout(function(){n.remove(i.element,"dragged")},0),n.remove(i.element,"is-dragging"),this.emitEvent("dragEnd",[this,t,e])},f.prototype.onMSPointerCancel=f.prototype.onpointercancel=function(t){t.pointerId===this.pointerIdentifier&&this.dragEnd(t,t)},f.prototype.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);this.dragEnd(t,e)},f.prototype.animate=function(){if(this.isDragging){this.positionDrag();var t=this;p(function(){t.animate()})}};var w=m?function(t,e){return"translate3d( "+t+"px, "+e+"px, 0)"}:function(t,e){return"translate( "+t+"px, "+e+"px)"};return f.prototype.setLeftTop=function(){this.options.forceTranslatePositioning?this.element.style[y]=w(this.position.x,this.position.y):(this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px")},f.prototype.positionDrag=y?function(){this.element.style[y]=this.options.forceTranslatePositioning?w(this.position.x,this.position.y):w(this.dragPoint.x,this.dragPoint.y)}:f.prototype.setLeftTop,f.prototype.enable=function(){this.isEnabled=!0},f.prototype.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},f}for(var o,r=t.document,s=r.defaultView,a=s&&s.getComputedStyle?function(t){return s.getComputedStyle(t,null)}:function(t){return t.currentStyle},u="object"==typeof HTMLElement?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName},c=0,h="webkit moz ms o".split(" "),p=t.requestAnimationFrame,f=t.cancelAnimationFrame,l=0;l<h.length&&(!p||!f);l++)o=h[l],p=p||t[o+"RequestAnimationFrame"],f=f||t[o+"CancelAnimationFrame"]||t[o+"CancelRequestAnimationFrame"];p&&f||(p=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-c)),o=t.setTimeout(function(){e(i+n)},n);return c=i+n,o},f=function(e){t.clearTimeout(e)}),"function"==typeof define&&define.amd?define(["classie/classie","eventEmitter/EventEmitter","eventie/eventie","get-style-property/get-style-property","get-size/get-size"],n):t.Draggabilly=n(t.classie,t.EventEmitter,t.eventie,t.getStyleProperty,t.getSize)}(window);var Matrix=function(t){"use strict";function e(t,e,i,n){return(void 0===n||-1>n)&&(n=i+1),new a(t,i,n,e.col.start,e.col.end)}function i(t,e,i,n){return(void 0===n||-1>n)&&(n=i+1),new a(t,e.row.start,e.row.end,i,n)}function n(t,e){return t[e]}function o(t,e){var i=t.slice(e.row.start,e.row.end).map(function(t){return t.slice(e.col.start,e.col.end)});return 0===i.length&&(i=void 0),i}function r(t,e,i){return t[e]?t[e][i]:void 0}function s(t){return new a(t,0,t.size()[0],0,t.size()[1])}function a(t,e,i,n,o){this.row={start:e,end:i},this.col={start:n,end:o},this.matrix=t}a.prototype.rows=function(t,i){return e(this.matrix,this,t,i)},a.prototype.cols=function(t,e){return i(this.matrix,this,t,e)},a.prototype.val=function(){return o(this.matrix._,this)},a.prototype.size=function(){return[this.row.end-this.row.start,this.col.end-this.col.start]},a.prototype.each=function(t){var e,i,n,o=this.row.end,r=this.col.end;for(e=this.row.start;o>e;e++)for(i=this.col.start;r>i;i++)n=this.matrix.get(e,i),t(n,e,i)},a.prototype.map=function(t){var e=this;return this.each(function(i,n,o){e.matrix._[n]||(e.matrix._[n]=[]),t?e.matrix._[n][o]=t(i,n,o):e.matrix._[n][o]=null}),this.matrix},a.prototype.some=function(t){var e=!1;return this.each(function(i,n,o){t(i,n,o)&&(e=!0)}),e};var u=function(t){this._=t||[[]],this.selection=s(this)};return u.prototype.get=function(t,e){var i;return this.selection=s(this),i=void 0===e&&void 0!==t?n(this._,t):void 0===t?o(this._,this.selection):r(this._,t,e)},u.prototype.put=function(t,e,i){return this._[t][e]=i,this},u.prototype.size=function(){return[this._.length,this._[0].length]},u.prototype.rows=function(t,i){return e(this,this.selection,t,i)},u.prototype.cols=function(t,e){return i(this,this.selection,t,e)},u.prototype.each=function(e){t.each(this._,function(i,n){t.each(i,function(t,i){e(t,n,i)})})},u.prototype.map=function(e){var i=this;return t.each(this._,function(n,o){t.each(n,function(t,n){i.put(o,n,e(t,o,n))})}),this},u.prototype.some=function(e){return t.some(this._,function(i,n){return t.some(i,function(t,i){return e(t,n,i)})})},u}(_),Pocketry=function(t,e){"use strict";function i(n,o,r){function s(){this.container=t(n),r=r||{},c.slotSize=r.slotSize||100,c.filterClass=r.filterClass||"is-hidden";var e=c.determineColCount();e&&(c.layout=new Pocketry.Layout(e,o),c.initTiles(this.container),this.draggable(),window.addEventListener("resize",Pocketry.debounce(10,c.onResize)))}function a(t){return t[0].offsetHeight>0&&t[0].offsetWidth>0}function u(t){t.hidden=t.el.hasClass("is-hidden")}var c=this;this.initTiles=function(i){var n=this,o=e.map(i.children(),function(i,o){var r=t(i).attr("data-type"),s=t(i).attr("data-tileid"),a=Boolean(t(i).attr("data-freezed")),u=e.extend(e.clone(n.getTileType(r)),{el:t(i),id:"#"+(o+1),freezed:a,tileId:s});return u});return o.forEach(n.add),o.forEach(n.position),n.updateContainerDimensions(),o},this.getTileType=function(t){return i.TILES[t]||i.TILES[0]},this.onResize=function(){a(c.container)&&(c.updateContainerDimensions(),c.relayout())},this.relayout=function(t){this.layout.stack.map(u),this.layout.rebuild(),this.layout.stack.forEach(function(t){t!==c._dragTile&&c.position(t)}),t&&t.parentNode.appendChild(t),this.publish("relayout")},this.updateContainerDimensions=function(){this.container.css("width",""),this.layout.colCount=this.determineColCount(),this.container.css({width:this.layout.colCount*this.slotSize+"px",height:this.layout.matrix.size()[0]*this.slotSize+"px"})},this.add=function(t){t.hidden=t.el.hasClass(c.filterClass),t.el.css({width:t.size[0]*c.slotSize+"px",height:t.size[1]*c.slotSize+"px"}),c.layout.add(t)},this.position=function(t){var e=t.position.x*c.slotSize,i=t.position.y*c.slotSize,n="translate("+e+"px, "+i+"px)";t.el.css({"-webkit-transform":n,transform:n})},this.determineColCount=function(){var t=this.container[0],e=1;return t&&(e=Math.floor(t.offsetWidth/this.slotSize)),e},s.call(c)}return i.TILES={pin:{size:[1,1],icon:"○"},app:{size:[2,2],icon:"□"},feed:{size:[3,2],icon:"▭"},placeholder:{size:[1,1]}},i}(jQuery,_);Pocketry.Layout=function(){"use strict";function t(t,e){this.colCount=t,this.rowSpan=e,this.init()}function e(t){return void 0!==t&&null!==t}function i(t){return function(i){return i.some(e)?!1:(i.map(function(){return t}),t.position={x:i.col.start,y:i.row.start},!0)}}function n(t,e){var i={x:t.x,y:t.y};return i.x=Math.max(0,t.x),i.x=Math.min(e[1],t.x),i.y=Math.max(0,t.y),i.y=Math.min(e[0],t.y),i}function o(t,e){var i=t.y%e;return 0!==i&&(t.y-=i),t}function r(t,e,i){return t.x>=e?(t.x=0,t.y+=i):t.x+=1,t}function s(t,e){var i=e[e.length-1];return t.x>i.position.x&&t.y>=i.position.y}return t.prototype.init=function(){this.stack=[],this.matrix=this.initMatrix(),delete this.scanStartPosition},t.prototype.initMatrix=function(){return(new Matrix).rows(0,this.rowSpan).cols(0,this.colCount).map()},t.prototype.add=function(t){if(t.hidden)return this.stack.push(t),[];if(this._canFitTile(t)){var e=this.walk(i(t),t.size,this.scanStartPosition);if(e)return this._markRowAsScanned(),this.extend(),this.add(t);this._markScanPositionAtTile(t),this.stack.push(t)}return[]},t.prototype._canFitTile=function(t){return t.size[0]<=this.matrix.size()[1]},t.prototype._markRowAsScanned=function(){this.scanStartPosition={col:0,row:this.matrix.size()[0]}},t.prototype._markScanPositionAtTile=function(t){t.size[1]>=this.rowSpan&&(this.scanStartPosition={col:t.position.x+t.size[0],row:this.scanStartPosition?this.scanStartPosition.row:0})},t.prototype.move=function(t,e){if(!t.freezed){null==e&&(e=-1);var i=this.stack;_.remove(i,t),-1!==e?i.splice(e,0,t):i.push(t),this.rebuild()}},t.prototype.rebuild=function(){var t=this,e=this.stack;this.init(),e.forEach(function(e){t.add(e)})},t.prototype.getTile=function(t){return this.matrix.get(t.y,t.x)},t.prototype.moveTo=function(t,e){var i=this.getStackNeighbor(e);if(!i||!i.freezed){var n=this.getTileInsertIndex(i,e);this.move(t,n)}},t.prototype.getStackNeighbor=function(t){t=n(t,this.matrix.size());for(var e=this.matrix.get(t.y,t.x);!e&&(t=o(t,this.rowSpan),t=r(t,this.matrix.size()[1]-1,this.rowSpan),!s(t,this.stack));)e=this.getStackNeighbor(t);return e},t.prototype.getTileInsertIndex=function(t,e){if(!t)return-1;var i=this.stack.indexOf(t),n=t.position;return e.x>n.x+t.size[0]/2&&(i+=1),i},t.prototype.walk=function(t,e,i){e=e||[1,1],i=i||{col:0,row:0};for(var n=!1,o=i.row,r=this.matrix.size()[0];r>o&&!n;){var s=this._getRowToScan(o,i.col);n=this._scanRow(s,e,t),o+=this.rowSpan}return!n},t.prototype._getRowToScan=function(t,e){return this.matrix.rows(t,t+this.rowSpan).cols(e,this.matrix.size()[1])},t.prototype._scanRow=function(t,e,i){for(var n=0,o={row:{start:0,end:0},col:{start:0,end:0}},r=!1,s=this._getNumberOfScanSteps(t,e);s>n&&!r;)o=this._nextTopDownScanStep(n,e,t),r=i(this.matrix.rows(o.row.start,o.row.end).cols(o.col.start,o.col.end),n),n++;return r},t.prototype._getNumberOfScanSteps=function(t,e){var i=t.size(),n=i[0]-e[1]+1,o=i[1]-e[0]+1;return n*o},t.prototype._nextTopDownScanStep=function(t,e,i){var n,o,r;r=i.size()[0]-e[1]+1,o=i.col.start+Math.floor(t/r),n=i.row.start+t%r;var s={row:{start:n,end:n+e[1]},col:{start:o,end:o+e[0]}};return s},t.prototype.extend=function(){var t=this.matrix.size()[0];this.matrix.rows(t,t+this.rowSpan).map()},t}(),function(t,e){"use strict";Pocketry.prototype.draggable=function(){function e(t){var e=Pocketry.offset(n.container);return{x:t.pageX-e.left,y:t.pageY-e.top}}function i(t,e){return{x:Math.floor(t.x/e),y:Math.floor(t.y/e)}}var n=this;return this.init=function(){var e=this.container.children(":not(.draggable) :not([data-freezed=true])");return t.each(e,function(e,i){var o=new Draggabilly(i,{containment:n.container[0],forceTranslatePositioning:!0});o.on("dragStart",n.onPick),o.on("dragMove",Pocketry.debounce(50,function(){n._dragTile&&n.onMove.apply(n,arguments)})),o.on("dragEnd",n.onDrop),t(i).addClass("draggable")}),e},this.onPick=function(t,e,i){n._dragTile=n.determineTile(t.position,n.layout.matrix,n.slotSize)},this.onMove=function(t,e,i){console.debug(t.position,i.x,i.y)},this.onDrop=function(t,i,o){var r=e(o),s=n.determineDropTarget(r),a=n._dragTile;delete n._dragTile,a===s.tile?n.position(a):(n.layout.moveTo(a,s.tilePosition),n.relayout()),n.publish("tile-dropped",{tile:a,distance:t.dragPoint})},this.determineTile=function(t){var e=i(t,this.slotSize);return this.layout.getTile(e)},this.determineDropTarget=function(t){return{position:t,tilePosition:i(t,this.slotSize),tile:this.determineTile(t)}},this.init.call(this),n}}(jQuery,_),Pocketry.prototype.publish=function(t,e){var i=this.subscriptions&&this.subscriptions[t];if(i){var n=this;i.forEach(function(t){t.call(n,e)})}},Pocketry.prototype.subscribe=function(t,e){var i=this.subscriptions;i||(i=this.subscriptions={}),i[t]||(i[t]=[]),i[t].push(e),console.log("subscriptions",i)},Pocketry.prototype.unsubscribe=function(t,e){if(this.subscriptions&&this.subscriptions[t])if(null!=e){var i=this.subscriptions[t].indexOf(e);i>=0&&this.subscriptions[t].splice(i,1)}else this.subscriptions[t]=[]},Pocketry.prototype.deafen=function(){this.subscriptions={}},Pocketry.debounce=function(t,e){var i;return function(){var n=this,o=arguments;i&&(clearTimeout(i),i=null),i=setTimeout(function(){e.apply(n,o),i=null},t)}},Pocketry.offset=function(t){var e=t[0],i=document.documentElement||document.body,n=window.pageXOffset||i.scrollLeft,o=window.pageYOffset||i.scrollTop,r=e.getBoundingClientRect().left+n,s=e.getBoundingClientRect().top+o;return{left:r,top:s}};